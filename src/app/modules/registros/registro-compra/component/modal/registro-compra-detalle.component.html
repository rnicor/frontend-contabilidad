<div mat-dialog-title>
    <div class="relative flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between">
        <span class="text-3xl tracking-tight" *ngIf="!registroCompraDetalle.id">Agregar registro</span>
        <span class="text-3xl tracking-tight" *ngIf="registroCompraDetalle.id">Modificar registro</span>
        <div class="flex items-center justify-end pt-6">
            <button
                mat-icon-button
                (click)="close()">
                <mat-icon
                    [svgIcon]="'heroicons_outline:x'"></mat-icon>
            </button>
        </div>
    </div>
</div>

<mat-dialog-content>
    <form [formGroup]="registroForm">
        <div class="grid sm:grid-cols-6 gap-6 w-full">

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>NIT Proveedor:</mat-label>
                    <input [formControlName]="'nitProveedor'" matInput>
                </mat-form-field>
                <div class="messages" *ngIf="f.nitProveedor.touched && f.nitProveedor.invalid">
                    <mat-error *ngIf="f.nitProveedor.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.nitProveedor.hasError('maxlength')">
                        El campo debe tener como maximo 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Codigo de Autorización:</mat-label>
                    <input [formControlName]="'codigoAutorizacion'" matInput>
                </mat-form-field>
                <div class="messages" *ngIf="f.codigoAutorizacion.touched && f.codigoAutorizacion.invalid">
                    <mat-error *ngIf="f.codigoAutorizacion.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.codigoAutorizacion.hasError('maxlength')">
                        El campo debe tener como maximo 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Número Factura:</mat-label>
                    <input [formControlName]="'numeroFactura'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.numeroFactura.touched && f.numeroFactura.invalid">
                    <mat-error *ngIf="f.numeroFactura.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.numeroFactura.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Número DUI/DIM:</mat-label>
                    <input [formControlName]="'numeroDui'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.numeroDui.touched && f.numeroDui.invalid">
                    <mat-error *ngIf="f.numeroDui.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.numeroDui.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Fecha Factura/DUI/DIM: </mat-label>
                    <input matInput [matDatepicker]="picker" [formControlName]="'fechaFactura'">
                    <mat-datepicker-toggle matprefix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
                <div class="messages" *ngIf="f.fechaFactura.touched && f.fechaFactura.invalid">
                    <mat-error *ngIf="f.fechaFactura.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Importe Total Compra:</mat-label>
                    <input [formControlName]="'importeTotalCompra'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.importeTotalCompra.touched && f.importeTotalCompra.invalid">
                    <mat-error *ngIf="f.importeTotalCompra.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.importeTotalCompra.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Importe ICE:</mat-label>
                    <input [formControlName]="'importeIce'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.importeIce.touched && f.importeIce.invalid">
                    <mat-error *ngIf="f.importeIce.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.importeIce.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Importe IEHD:</mat-label>
                    <input [formControlName]="'importeIehd'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.importeIehd.touched && f.importeIehd.invalid">
                    <mat-error *ngIf="f.importeIehd.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.importeIehd.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Importe IPJ:</mat-label>
                    <input [formControlName]="'importeIpj'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.importeIpj.touched && f.importeIpj.invalid">
                    <mat-error *ngIf="f.importeIpj.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.importeIpj.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Tasas:</mat-label>
                    <input [formControlName]="'tasas'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.tasas.touched && f.tasas.invalid">
                    <mat-error *ngIf="f.tasas.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.tasas.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Otro No Sujeto a Crédito Fiscal:</mat-label>
                    <input [formControlName]="'otroNoSujetoIva'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.otroNoSujetoIva.touched && f.otroNoSujetoIva.invalid">
                    <mat-error *ngIf="f.otroNoSujetoIva.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.otroNoSujetoIva.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Importes Exentos:</mat-label>
                    <input [formControlName]="'importesExentos'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.importesExentos.touched && f.importesExentos.invalid">
                    <mat-error *ngIf="f.importesExentos.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.importesExentos.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Importe Compras Gravadas a Tasa Cero:</mat-label>
                    <input [formControlName]="'comprasGravadasTasaCero'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.comprasGravadasTasaCero.touched && f.comprasGravadasTasaCero.invalid">
                    <mat-error *ngIf="f.comprasGravadasTasaCero.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.comprasGravadasTasaCero.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Subtotal:</mat-label>
                    <input [formControlName]="'subtotal'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.subtotal.touched && f.subtotal.invalid">
                    <mat-error *ngIf="f.subtotal.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.subtotal.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Descuentos Bonificaciones y Rebajas Sujetas al IVA:</mat-label>
                    <input [formControlName]="'descuentosBonificacionesRebajasSujetasIva'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.descuentosBonificacionesRebajasSujetasIva.touched && f.descuentosBonificacionesRebajasSujetasIva.invalid">
                    <mat-error *ngIf="f.descuentosBonificacionesRebajasSujetasIva.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.descuentosBonificacionesRebajasSujetasIva.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Importe Gift Card:</mat-label>
                    <input [formControlName]="'importeGiftCard'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.importeGiftCard.touched && f.importeGiftCard.invalid">
                    <mat-error *ngIf="f.importeGiftCard.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.importeGiftCard.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Importe Base Crédito Fiscal:</mat-label>
                    <input [formControlName]="'importeBaseCreditoFiscal'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.importeBaseCreditoFiscal.touched && f.importeBaseCreditoFiscal.invalid">
                    <mat-error *ngIf="f.importeBaseCreditoFiscal.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.importeBaseCreditoFiscal.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Crédito Fiscal:</mat-label>
                    <input [formControlName]="'creditoFiscal'" matInput type="number">
                </mat-form-field>
                <div class="messages" *ngIf="f.creditoFiscal.touched && f.creditoFiscal.invalid">
                    <mat-error *ngIf="f.creditoFiscal.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.creditoFiscal.hasError('maxlength')">
                        El campo debe tener como nombre 50 caracteres
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label>Tipo Compra:</mat-label>
                    <mat-select [formControlName]="'tipoCompra'">
                        <mat-option [value]="null">--Seleccione--</mat-option>
                        <mat-option *ngFor="let s of registroCompraInicio.tiposCompra" [value]="s.codigo">{{s.nombre}}</mat-option>
                    </mat-select>
                </mat-form-field>
                <div class="messages" *ngIf="f.tipoCompra.touched && f.tipoCompra.invalid">
                    <mat-error *ngIf="f.tipoCompra.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                </div>
            </div>

            <div class="sm:col-span-2">
                <mat-form-field class="fuse-mat-no-subscript w-full">
                    <mat-label><span class="text-warn">(*)</span>Código de Control:</mat-label>
                    <input [formControlName]="'codigoControl'" matInput>
                </mat-form-field>
                <div class="messages" *ngIf="f.codigoControl.touched && f.codigoControl.invalid">
                    <mat-error *ngIf="f.codigoControl.hasError('required')">
                        Este campo es requerido
                    </mat-error>
                    <mat-error *ngIf="f.codigoControl.hasError('maxlength')">
                        El campo debe tener como maximo 50 caracteres
                    </mat-error>
                </div>
            </div>
        </div>
    </form>
</mat-dialog-content>

<mat-dialog-actions>
    <button class="mat-raised-button"(click)="close()"><mat-icon svgIcon="heroicons_outline:x"></mat-icon> Cancelar</button>
    <button class="mat-raised-button mat-primary"(click)="guardar()"
            [disabled]="disabledForm" *ngIf="!registroCompraDetalle.id">
        <ng-container *ngIf="!disabledForm">
            <mat-icon svgIcon="mat_outline:save"></mat-icon>
            <span>Guarda registro</span>
        </ng-container>
        <mat-progress-spinner
            *ngIf="disabledForm"
            [diameter]="24"
            [mode]="'indeterminate'"></mat-progress-spinner>
    </button>
    <button class="mat-raised-button mat-primary"(click)="modificar()"
            [disabled]="disabledForm" *ngIf="registroCompraDetalle.id">
        <ng-container *ngIf="!disabledForm">
            <mat-icon svgIcon="mat_outline:save"></mat-icon>
            <span>Modificar registro</span>
        </ng-container>
        <mat-progress-spinner
            *ngIf="disabledForm"
            [diameter]="24"
            [mode]="'indeterminate'"></mat-progress-spinner>
    </button>
</mat-dialog-actions>
